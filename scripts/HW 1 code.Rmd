---
title: "Homework 1"
author: "Raleigh Goodwin, Kavya Mudiam, Vinita Vader, Zach Shroeder, Ann-Marie Barrett"
date: "2/2/2021"
output: html_document
---

```{r}
library(dplyr)
library(rio)
library(ggplot2)
library(here)
library(forcats)

```

```{r}
here::here()

assessments <- import(here::here("data/assessments.csv"))
courses <- import(here::here("data/courses.csv"))
studentAssessment <- import(here::here("data/studentAssessment.csv"))
studentInfo <- import(here::here("data/studentInfo.csv"))
studentReg <- import(here::here("data/studentRegistration.csv"))
studentVle <- import(here::here("data/studentVle.csv")) # there is no such file
vle <- import(here::here("data/vle.csv")) # no such file
```

#Use at least 3 mutating joins
```{r}
df <- right_join(studentAssessment, studentInfo, by = "id_student")
df <- left_join(df, assessments, by = c("id_assessment", "code_presentation", "code_module"))
df <- full_join(df, courses, by = c("code_presentation", "code_module"))
```

#Use at least 1 filtering join
```{r}
TMA <- assessments %>%
  filter(assessment_type == "TMA") %>% 
  select(assessment_type)

df <- df %>% 
  semi_join(TMA)
```



#Reproduce the figure
##reordering factors, etc 
```{r}
#prep data/as.factor, etc
df$highest_education <- as.factor(df$highest_education)
df <- df %>% 
  group_by(highest_education, final_result, gender) %>% 
  mutate(average_score = mean(score, na.rm = T))
```

##plot
```{r}
#reproducing the plot
ggplot(df, aes(fct_reorder(highest_education, average_score), average_score)) +
  geom_line(aes(group = highest_education), color = "cornflowerblue") + 
  geom_point(aes(color = gender)) +             #CHANGE TO BLUE COLOR
  coord_flip() +
  facet_wrap(~fct_reorder(final_result, average_score), nrow = 4)+
  theme_minimal()
# add the labels

```

## Figures
```{r}
#Figure 1
```

```{r}
#Figure 2
```

```{r}
#Figure 3
```

##format (colors, labels) <-- Zach